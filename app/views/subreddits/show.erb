<% if @subreddit.is_private == false || 
  (@subreddit.is_private == true && subscription = Subscription.find_by(user_id: @user.id, subreddit_id: @subreddit.id, access: true) )%>

  <% if @posts %>
    <!-- If current user has a aubscription wth access equal to true, show posts -->
    <% @posts.each do |post| %>
      <% if post.post_type_id == 1 %>
        <h5><a href="<%= post.link %>"><%= post.title %></a></h5>
      <% else %>
        <h5><a href="/r/<%= @subreddit.slug %>/<%= post.slug %>/comments"><%= post.title %></a></h5>
        <a href="/r/<%= @subreddit.slug %>/<%= post.slug %>/comments"><button>Comments</button></a><br>
      <% end %>
    <% end %>
  <% end %>

<% else %>
  <h1>Sorry, but you need to be subscribed to view this subreddit.</h1>

  <!-- If they already had a subscription request. -->
  <% subscription =  Subscription.find_by(user_id: @user.id, subreddit_id: @subreddit.id) %>
  <% request = SubscriptionRequest.find_by(user_id: @user.id, subscription_id: subscription.id) if !!subscription %>
  <% if request %>
    <p>Your subscription request: <%= request.status %></p>
  <% end %>
<% end %>

<div class="subreddit-info">
  <form method="post" action="/r/<%= @subreddit.slug %>/subscribe">
    <input type="submit" value="Subscribe">
  </form>
  <br>

  <h4><a href="/r/<%= @subreddit.slug %>">/r/<%= @subreddit.name %></a></h4>
  <br>
  <h5>Descripton</h5>
  <p><%= @subreddit.description %></p>

</div>